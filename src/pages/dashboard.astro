---
import Layout from '../layouts/Layout.astro';
import { XataClient } from '../xata';

const user = Astro.cookies.get('userId');
if (!user) {
  return Astro.redirect('/');
}

// if (Astro.request.method === 'POST') {
//   const xata = new XataClient({ apiKey: import.meta.env.XATA_API_KEY });
//   const data = await Astro.request.formData();
//   const file = data.get('file') as string;

//   await xata.files.upload(
//     { table: 'files', column: 'file', record: file },
//     file
//   );

//   return Astro.redirect('/dashboard', 302);
// }

// const xata = new XataClient({ apiKey: import.meta.env.XATA_API_KEY });
// const data = await xata.db.files.getFirst();
// console.log(data);
---

<Layout title='Dashboard'>
  <div
    class='max-lg:px-24 px-48 z-20 py-12 max-sm:px-5 max-sm:py-10 max-w-7xl w-full mx-auto flex flex-col gap-y-10 items-center justify-center'
  >
    <h1 class='text-center text-3xl text-slate-700'>
      It seems you didn't upload any files yet. <span class='text-orange-600'
        >Let's start!!</span
      >
    </h1>
    <form
      class='flex items-center gap-x-6 max-md:flex-col max-md:gap-y-6'
      method='POST'
      action='/api/upload'
      enctype='multipart/form-data'
    >
      <input
        type='file'
        name='file'
        id='file'
        class='file-input file-input-bordered border-orange-600 file-input-[orange-600] w-full max-w-xs'
      />
      <button
        type='submit'
        class='border border-slate-600 bg-transparent text-orange-600 py-2.5 px-4 rounded-md hover:bg-orange-600 hover:border-orange-600 hover:text-white'
      >
        Upload
      </button>
    </form>
  </div>
</Layout>
